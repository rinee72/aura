# 에뮬레이터 실행 실패 원인 분석

## 🔍 현재 상황

### 확인된 상태
- ✅ **에뮬레이터 실행 파일 존재**: `emulator.exe` 파일이 정상적으로 설치되어 있음
- ✅ **AVD 인식**: Flutter가 "Pixel_5" 에뮬레이터를 정상적으로 인식
- ❌ **프로세스 미실행**: 에뮬레이터 프로세스(qemu, emulator)가 실행되지 않음
- ⚠️ **ADB 연결 실패**: `emulator-5554`가 감지되지만 "offline" 상태

---

## 🎯 주요 원인 분석

### 1. **에뮬레이터 프로세스가 즉시 종료되는 문제**

**증상:**
- `flutter emulators --launch Pixel_5` 명령 실행 시 에러 없이 완료
- 하지만 실제로 에뮬레이터 창이 나타나지 않음
- 프로세스 목록에 qemu/emulator 프로세스가 없음

**가능한 원인:**

#### A. **하이퍼바이저(Hypervisor) 문제**
```
Android 에뮬레이터는 가상화 기술을 사용합니다.
Windows에서는 Hyper-V, HAXM, 또는 Windows Hypervisor Platform이 필요합니다.
```
- **Hyper-V 비활성화**: Windows에서 Hyper-V가 비활성화되어 있을 수 있음
- **HAXM 미설치**: Intel HAXM이 설치되지 않았을 수 있음
- **가상화 미지원**: CPU가 하드웨어 가상화를 지원하지 않거나 BIOS에서 비활성화됨

#### B. **경로 문제 (한글 사용자명)**
```
사용자 경로: C:\Users\박인희\...
```
- **한글 경로**: 사용자명에 한글이 포함되어 있어 일부 도구가 경로를 제대로 처리하지 못할 수 있음
- **AVD 경로**: AVD 파일 경로에 한글이 포함되면 에뮬레이터가 시작 실패할 수 있음

#### C. **시스템 리소스 부족**
- **RAM  공간 필요부족**: 에뮬레이터는 최소 2GB 이상의 RAM이 필요
- **디스크 공간 부족**: AVD 파일과 스냅샷 저장
- **CPU 부족**: 가상화에 충분한 CPU 성능 필요

#### D. **AVD 설정 오류**
- **시스템 이미지 손상**: 다운로드한 시스템 이미지가 손상되었을 수 있음
- **AVD 설정 파일 오류**: `config.ini` 또는 `hardware-qemu.ini` 파일에 문제가 있을 수 있음
- **스냅샷 문제**: 이전 실행의 스냅샷이 손상되어 부팅 실패

---

## 🔧 Flutter의 에뮬레이터 실행 과정

### 정상적인 실행 흐름:
```
1. flutter emulators --launch Pixel_5
   ↓
2. Flutter가 Android SDK 경로에서 emulator.exe 찾기
   ↓
3. emulator.exe -avd Pixel_5 명령 실행
   ↓
4. QEMU 프로세스 시작 (가상 머신 실행)
   ↓
5. Android 시스템 부팅 시작
   ↓
6. ADB가 에뮬레이터 감지 (emulator-5554)
   ↓
7. 에뮬레이터 창 표시 및 홈 화면 로드
```

### 현재 상황:
```
1. flutter emulators --launch Pixel_5 ✅
   ↓
2. Flutter가 Android SDK 경로에서 emulator.exe 찾기 ✅
   ↓
3. emulator.exe -avd Pixel_5 명령 실행 ✅
   ↓
4. QEMU 프로세스 시작 시도 ❌ (즉시 종료)
   ↓
5. Android 시스템 부팅 실패 ❌
   ↓
6. ADB가 에뮬레이터 감지하지만 offline 상태 ⚠️
```

---

## 🛠️ 문제 해결 방법

### 방법 1: Android Studio에서 직접 실행 (권장)
**이유**: Android Studio는 에뮬레이터 실행 시 더 자세한 에러 메시지를 제공합니다.

1. **Android Studio 열기**
2. **Tools > Device Manager**
3. **Pixel 5 에뮬레이터 옆의 재생 버튼(▶) 클릭**
4. **에러 메시지 확인** (있다면)
   - 에러 메시지가 나타나면 그 내용을 확인하여 정확한 원인 파악 가능

### 방법 2: Cold Boot 시도
**이유**: 스냅샷 문제를 우회할 수 있습니다.

1. **Android Studio > Device Manager**
2. **Pixel 5 옆의 점 3개(⋮) 메뉴 클릭**
3. **"Cold Boot Now" 선택**

### 방법 3: 하이퍼바이저 확인 및 설정

#### Windows Hypervisor Platform 활성화:
1. **제어판 > 프로그램 > Windows 기능 켜기/끄기**
2. **"Windows Hypervisor Platform" 체크**
3. **재부팅**

#### 또는 Intel HAXM 설치:
1. **Android Studio > SDK Manager**
2. **SDK Tools 탭**
3. **"Intel x86 Emulator Accelerator (HAXM installer)" 체크 및 설치**

### 방법 4: AVD 재생성
**이유**: 손상된 AVD 설정을 초기화합니다.

1. **Android Studio > Device Manager**
2. **Pixel 5 에뮬레이터 삭제**
3. **새 에뮬레이터 생성**
4. **시스템 이미지 다시 다운로드**

### 방법 5: 명령줄에서 직접 실행하여 에러 확인
```powershell
cd $env:LOCALAPPDATA\Android\Sdk\emulator
.\emulator.exe -avd Pixel_5 -verbose
```
이 명령은 상세한 로그를 출력하여 정확한 실패 원인을 알려줍니다.

---

## 📊 진단 체크리스트

다음 항목들을 확인해보세요:

- [ ] **하이퍼바이저 활성화 여부**
  - Windows 기능에서 "Windows Hypervisor Platform" 또는 "Hyper-V" 활성화
  - BIOS에서 가상화(VT-x/AMD-V) 활성화

- [ ] **시스템 리소스**
  - 최소 8GB RAM 권장
  - 충분한 디스크 공간 (AVD당 약 2-4GB)

- [ ] **AVD 설정**
  - 시스템 이미지가 정상적으로 다운로드되었는지 확인
  - AVD 설정 파일이 손상되지 않았는지 확인

- [ ] **경로 문제**
  - 사용자명에 특수문자나 한글이 있으면 문제가 될 수 있음
  - AVD 경로에 공백이나 특수문자가 없는지 확인

- [ ] **방화벽/보안 소프트웨어**
  - 방화벽이나 백신 프로그램이 에뮬레이터 실행을 차단하지 않는지 확인

---

## 💡 권장 조치 사항

1. **즉시 시도**: Android Studio에서 에뮬레이터를 직접 실행하여 에러 메시지 확인
2. **에러 메시지 확인**: Android Studio에서 나타나는 에러 메시지를 기록
3. **로그 확인**: 명령줄에서 `-verbose` 옵션으로 실행하여 상세 로그 확인
4. **단계별 해결**: 위의 해결 방법을 순서대로 시도

---

## 🔗 참고 자료

- [Android Emulator 문제 해결 가이드](https://developer.android.com/studio/run/emulator-troubleshooting)
- [Flutter Android 설정](https://docs.flutter.dev/get-started/install/windows)
- [Windows Hypervisor Platform](https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/)
